---
const { images } = Astro.props;
---

<section class="flex flex-col gap-10 items-center my-24">
  <h2 class="text-[60px] font-bold uppercase text-center">
    Experiencias que vivirás
  </h2>
  <section class="w-[1000px] grid grid-cols-4 gap-4">
    {images.map((image, index) => (
      <article key={index}>
        <img
          class="aspect-square object-cover rounded-lg cursor-pointer"
          src={image.src}
          alt={image.alt}
          data-index={index}
          onClick={() => openLightbox(index)}
        />
      </article>
    ))}
  </section>

  <!-- Overlay for expanded image -->
  <div id="lightbox" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center hidden">
    <button id="close" class="absolute top-4 right-4 text-white text-2xl">✕</button>
    <button id="prev" class="absolute left-4 text-white text-2xl">←</button>
    <img id="lightbox-image" class="max-w-full max-h-full object-cover" />
    <button id="next" class="absolute right-4 text-white text-2xl">→</button>
  </div>
</section>

<script>
  const images = {JSON.stringify(images)};

  let currentIndex = 0;

  function openLightbox(index) {
    const lightbox = document.getElementById('lightbox');
    const lightboxImage = document.getElementById('lightbox-image');

    currentIndex = index;
    lightboxImage.src = images[index].src;
    lightbox.classList.remove('hidden');
  }

  function closeLightbox() {
    const lightbox = document.getElementById('lightbox');
    lightbox.classList.add('hidden');
  }

  function showNextImage() {
    currentIndex = (currentIndex + 1) % images.length;
    document.getElementById('lightbox-image').src = images[currentIndex].src;
  }

  function showPrevImage() {
    currentIndex = (currentIndex - 1 + images.length) % images.length;
    document.getElementById('lightbox-image').src = images[currentIndex].src;
  }

  document.getElementById('close').addEventListener('click', closeLightbox);
  document.getElementById('next').addEventListener('click', showNextImage);
  document.getElementById('prev').addEventListener('click', showPrevImage);

  document.addEventListener('keydown', (event) => {
    if (event.key === 'Escape') {
      closeLightbox();
    } else if (event.key === 'ArrowRight') {
      showNextImage();
    } else if (event.key === 'ArrowLeft') {
      showPrevImage();
    }
  });

  document.getElementById('lightbox').addEventListener('click', (event) => {
    if (event.target === event.currentTarget) {
      closeLightbox();
    }
  });
</script>

<style>
  #lightbox {
    display: flex;
    align-items: center;
    justify-content: center;
  }
  #lightbox img {
    max-width: 80%;
    max-height: 80%;
  }
  #lightbox button {
    background: none;
    border: none;
    font-size: 2rem;
  }
</style>
